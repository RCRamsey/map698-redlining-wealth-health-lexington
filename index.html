<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='utf-8' />
    <title>Redlining Prevents Wealth</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Mapbox assembly minified css stylesheet-->
    <link href="https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.min.css" rel="stylesheet" />
    <!-- Mapbox GL JS Reference stylesheet-->
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css" rel="stylesheet" />

    <!-- my general css styles -->
    <link href='css/styles.css' rel='stylesheet' />

    <!-- remove prior to publishing final product DEVELOPMENTAL purposes only -->
    <!-- request styles for mapbox-gl-inspect  -->
    <!-- <link href='https://github.com/lukasmartinelli/mapbox-gl-inspect/releases/download/v1.3.1/mapbox-gl-inspect.css' rel='stylesheet' /> -->
    <!-- request js for mapbox-gl-inspect-->
    <!-- <script src='https://github.com/lukasmartinelli/mapbox-gl-inspect/releases/download/v1.3.1/mapbox-gl-inspect.js'></script> -->

    <!-- to consider loading other font -->
    <!-- <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,500,600' rel='stylesheet' type='text/css'> -->

    <style>
        /* styles stored in styles.css file */
    </style>
</head>

<body>
    <div id= 'displayContainer' class='grid h-full'>
        <!-- remember padding and margins are in multiples of 3 i.e. 3 6 9 12 etc other values won't change -->
        <header class='w-full bg-darken25 border-b border--white px12 py12 relative'>
            <header class='w-3/4'>
            <h1>Persistence of Racist Loan Practices in Contemporary Landscape of Lexington, KY: An Exploration of 1930s Redlining</h1>
            </header>
            <!-- Info Button to trigger open Modal -->
            <!-- -on-active is-active-->
            <button id='aboutMapButton' class='absolute right bottom mr9 mb3'>
                <a class='flex flex--center-main btn btn--stroke btn--white bg-darken25 bg-darken50-on-hover bg-gray-dark-on-active txt-s ml3'>
                    <svg class='icon txt-m mr2'>
                        <use xlink:href='#icon-bookmark' />
                    </svg> About Map
                </a>
            </button>
        </header>


        <div id='map1-container' class='col w-full w-1/2-ml h-viewport-1/2 h-viewport-full-ml relative'>
            <div id='map' class='h-full border border--white border--2'></div>
            <!-- map1 legend -->
            <div class='map-overlay bottom mb60 z0'>
                <div class='map-overlay-inner mx12 my3'>
                    <div id='legend1'>
                        <h3>Likelihood of Loan</h3>
                         <ul class='legend1-labels'>
                           <h3><li><span style='background:#E6EBEF;'></span> Unlikely</li></h3> 
                           <h3><li><span style='background:#C2CDD6;'></span> Somewhat Likely</li></h3> 
                            <h3><li><span style='background:#92A6B5;'></span> More Likely</li></h3> 
                            <h3><li><span style='background:#5B7386;'></span> Most Likely</li></h3> 
                         </ul>
                    </div>
                    
                </div>
            </div>


            <!-- Info Button to trigger open Modal -->
            <!-- -on-active is-active-->
            <button id='redliningButton' class='absolute top right mt18 mr18'>
                <a class='flex flex--center-main btn btn--stroke btn--white bg-darken25 bg-darken50-on-hover bg-gray-dark-on-active txt-s ml3 '
                    href='#'>
                    <svg class='icon txt-m mr2'>
                        <use xlink:href='#icon-bookmark' />
                    </svg> 1930's Lexington Redlining Map & History
                </a>
            </button>

        </div>
        <!-- insert opacity slider bar and give initial start opacity, use as developer tool-->
        <!-- <div class='map-overlay bottom ml24 mb36 z2 absolute'>
            <div class='map-overlay-inner'>
                <label>Redlined Layer Opacity: <span id='slider-value'>100%</span></label>
                <input id='slider' type='range' min='0' max='100' step='0' value='100'>
            </div>
        </div> -->
        <div id='map2-container' class='col w-full w-1/2-ml h-viewport-1/2 h-viewport-full-ml relative'>

            <div id='map2' class='h-full border border--white border--2'></div>
            <!-- bottom margin left margin -->
            <div class='map-overlay bottom mr-neg24 mb60 z0 absolute'>
                <div class='map-overlay-inner mx6 my3'>
                    <div id='legend2'>
                        <h3>Legend Label</h3>
                    </div>
                    <!-- legend-bar will be dynamically updated with JS based on selected attribute -->
                    <div id='legend2-bar'></div>
                    <!-- Add min & max labels -->
                    <div class='legend-label flex flex--space-between-main'>
                        <div id='legend2-label-min'>
                            <h3>0%</h3>
                        </div>
                        <div id='legend2-label-max'>
                            <h3>100%</h3>
                        </div>
                    </div>
                </div>
            </div>
            <!-- unordered list -->
            <ul class='absolute top right'>
                <li class='dropdown mx3 my18'>
                    <a class='flex flex--center-main btn btn--stroke btn--white bg-darken25 bg-darken50-on-hover bg-gray-dark-on-active txt-s ml3'
                        href='#'>
                        <svg class='icon txt-m mr1'>
                            <use xlink:href='#icon-layers' />
                        </svg> U.S. Census Data Menu
                    </a>
                    <div class='dropdown-content txt-m'>
                        <a value='race' href='#'>Segregation/Race</a>
                        <a value='income' href='#'>Median Household Income</a>
                        <a value='ownership' href='#'>% Home Ownership</a>
                        <a value='propertyValue' href='#'>Property Value Reported</a>
                    </div>
                </li>
            </ul>

        </div>

        <!-- The Modal to open from aboutMapButton -->
        <div id="aboutMapModal" class="modal z=0">
            <!-- Modal content -->
            <div class="modal-content">
                <!-- Close modal by clicking on span (x)-->
                <span class="closeAbout"><svg class ='icon link color-darken50'><use xlink:href='#icon-close'></use></svg></span>

                <!-- scrolling text; not sure you need this now since the modal is outside the map and will scroll -->
                <div class='px12 py12 overflow-auto h-full'>

                    <h3 class='txt-m txt-bold mb6'>About</h3>
                    <p> This map allows the user to explore the access (or denial of equitable access) of home ownership and its related
                       benefits under varying gauges of wealth in
                        the current locations of neighborhoods historically Redlined by the Home Owners Loan Corporation
                        (HOLC) in Lexington, Kentucky.
                        Aspects of wealth mapped include:
                    </p><br>
                    <p>
                        <li>Race/Segregation</li>
                        <li>Median Household Income</li>
                        <li>Home Ownership</li>
                        <li>Median Reported Property Value</li>
                    </p><br>
                    <p>
                        Race/Segregation may not initially be considered by all as an <i>aspect</i> of wealth, however,
                        in this instance
                        the HOLC Redlining practices ushered this category in as its inherently racist
                        practices negatively impacted the of populations of color within these neighborhoods. To learn more
                        about the
                        history of HOLC click the Redlining Map Info button on the map.
                    </p><br>

                    <h3 class='txt-m txt-bold mb6'>Styling</h3>
                    <p>
                        For this map, the traditional 1930s HOLC Redlining Map is displayed side-by-side with a map
                        containing the Census Bureau Data Layer of Interest (Race/Segregation,
                        Median Household Income, Home Ownership, and Median Reported Property Value.) A side-by-side
                        view was chosen because:
                    </p><br>
                    <p>
                        <li>The two maps are using two different polygon outlines for data. Census Bureau Tract level
                            data does not fall neatly into
                            the HOLC Redlining neighborhoods and to lay them on top of one another reduces clarity.</li>
                        <li> Syncing of the maps when zooming in or panning maps allows the user to identify both HOLC
                            level and Census Bureau level data for an area simultaneously.</li>
                    </p><br>
                    <p>
                        Historical HOLC Redlining Maps were designed initially with a color scheme to signify a hazard
                        or risk rating
                        of loaning to a homeowner in specific neighborhoods of a city.
                    </p><br>

                    <div class='align-center'>
                        <img class='w-1/3 align-center' src="graphics/lex_scores_redlining.jpg"
                            alt="Percentage of hazardous areas outlined by Home Owner's Loan Corporation and demographics of 1940 Lexington Kentucky"><br>
                        <h4 class='txt-m'>
                            <p><a
                                    href="https://dsl.richmond.edu/panorama/redlining//#loc=14/38.041/-84.526&city=lexington-ky&text=downloads">Mapping
                                    Inequality-Lexington</a>
                            </p><br>
                        </h4>
                    </div>

                    <p>The author chose to divert from the traditional
                        color scheme to a gradient level color scheme because:
                    </p><br>
                    <p>
                        <li>The primary goal of this map and the primary goal of the traditional HOLC Redlining map are
                            not the same and
                            the previous color scheme no longer serves the purpose of this map.
                        </li>
                        <li>The user is permiited to make clear connections between relationships of HOLC Grade assignments,
                            the likelihood of a homeowner being approved
                            for a loan through HOLC, and current aspects of denied wealth benefits. </li>
                        <li>The user no longer has to keep in their mind what Grade level (A-B-C-D) is associated with
                            what hazard level (Best-Still Desirable-Declining-Hazardous) and corresponds to what color
                            (Green-Blue-Yellow-Red).</li>
                        <li>Improves accessbility to those of varying vision abilities for whom red and green may not be
                            identified clearly.</li>
                        <li>Removes the color associations of the western world of red/bad or green/good.</li>
                        <li>Prevents perpetuating the association of race with hazardous conditions as was foundational
                            to the HOLC Redlining practices.</li>
                    </p><br>

                    <h3 class='txt-m txt-bold mb6'>Inspiration</h3>
                    <p> <i>How Racial Capitalism Persists today in Lexington, KY: An exploration of 1930s Redlining
                            Practices</i>
                        was authored by RC Ramsey as a part of a M.S. project at The University of Kentucky in the New
                        Maps Plus
                        graduate program. Ramsey was inspired by
                        <a
                            href="https://dsl.richmond.edu/panorama/redlining/#loc=14/38.041/-84.526&city=lexington-ky&text=intro">Mapping
                            Inequality Redlining in New Deal America</a>,
                        and an
                        <a
                            href="https://www.epa.gov/environmentaljustice/environmental-justice-systemic-racism-speaker-series#previous">Environmental
                            Justice & Systemic Racism Speaker Series</a>
                        hosted by the U.S. Environmental Protection Agency.
                    </p><br>

                    <h3 class='txt-m txt-bold mb6'>Intentions</h3>
                    <p>
                        This map is intended to provide information to a user. It alone will not repair or return the
                        wealth blocked from
                        occupants in Redlined areas. Policy changes through voting are how we will begin the effort
                        toward equity for the long
                        term resident's access to benefits from revitalization programs they have been excluded from in
                        the past. With information in hand,
                        informed users can use their vote to promote equitable projects and grant funding to benefit the
                        neighborhoods and occupants
                        continuing to be impacted by Redlining practices implemented decades ago.
                    </p>

                    <h3 class='txt-m txt-bold mb6'>License</h3>
                    <p>
                        The mapping project is licensed under the GNU General Public License v3.0.
                    </p><br>

                    <div class="modal-footer flex flex--center-cross">
                        <hr>
                        <a target="_blank" href="https://github.com/RCRamsey/map698-redlining-wealth-lexington">
                            <button type="button"
                                class="btn btn--stroke btn--white bg-darken25 bg-darken50-on-hover bg-gray-dark-on-active txt-m ml3">View
                                GitHub Repo</button>
                        </a>
                        <a href="https://newmapsplus.github.io">
                            <img src="https://newmapsplus.github.io/assets/graphics/logo-2018-nmp-75px-h-gray.png"
                                alt="University of Kentucky New Maps Plus">
                        </a>
                        <a href="https://uky-gis.github.io">
                            <img src="https://newmapsplus.github.io/assets/graphics/logo-2018-geography-75px-h.png"
                                alt="University of Kentucky Department of Geography">
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- The Modal to open from redliningButton -->
        <div id="redliningModal" class="modal z=0">
            <!-- Modal content -->
            <div class="modal-content">
                <!-- Close modal by clicking on span (x) -->
                <span class="close"><svg class ='icon link color-darken50'><use xlink:href='#icon-close'></use></svg></span>
                <!-- scrolling text; not sure you need this now since the modal is outside the map and will scroll -->
                <div class='px12 py12 overflow-auto h-full'>
                    <h3 class='txt-m txt-bold mb6'>Home Owner's Loan Corporation</h3>
                    <p> During the U.S. Great Depression of the 1930s, a drastic increase in unemployment reduced
                        the ability of home owner's to continue making payments on their homes mortgages. President
                        Roosevelt
                        emplored Congress to pass legislation to:
                    </p><br>

                    <ul>
                        <li>1. Prevent foreclosure of small home owners (of which were millions)</li>
                        <li>2. Alleviate some of their financial burden of their home</li>
                    </ul><br>

                    <p> President Roosevelt stated it was of <i>National</i> importance to safeguard home ownership.
                        It was these declarations that paved the way for HOLC.
                    </p><br>

                    <p>
                        <i>"Home Owner's Loan Corporation was established during the summer of 1933 to help families
                            prevent loss of their homes through mortgage foreclosure."
                        </i>
                    <h4 class='txt-s'>(Harriss 1951)</h4>
                    </p><br>

                    <p> There was nothing gradual about the creation of HOLC. In short notice a nation wide
                        corporation was cobbled together in attempts to open up the application
                        process and reduce the loss of the National Treasury while providing aid to what families they
                        could. The corporation needed appraisers on the ground, nationwide, with intimate local
                        knowledge, as
                        soon as possible. Initially program apprasiers were selected by state managers without any
                        defined
                        rules or regulation for their selection. It took 6 months before qualifications were outlined
                        and drawn up limiting the selection pool to real estate brokers, experienced appraisers, or
                        experienced builders/architects (Harriss 1951). Months passed before these rules were instituted
                        and met in each region.
                        It was the appraisers who were responsible, for building the ship while sailing it. In an effort
                        to aid
                        the appraisal process, appraisers outlined neighborhoods with Grades and color coding
                        corresponding to
                        a hazard rating.
                    </p><br>

                    <div class='align-center'>
                        <img class='w-1/3 align-center' src="graphics/lex_scores_redlining.jpg"
                            alt="Percentage of hazardous areas outlined by Home Owner's Loan Corporation and demographics of 1940 Lexington Kentucky"><br>
                        <h4 class='txt-s'>
                            <p> Nelson et al. accessed January 25, 2022
                            </p><br>
                        </h4>
                    </div>

                    <p>This hazard rating was intended to indicate to a lending institution the <i>potential foreclosure
                            risk</i>
                        posed by a home within neighborhoods outlined. The lowest risk was indicated with green and
                        labeled Grade A while the highest
                        risk was colored Red and given Grade D for being considered extremely risky or hazardous to loan
                        to. Applications from within the Grade D
                        neighborhoods were refused loans based on the <i>risk</i>.
                    </p><br>

                    <img class="img-fluid" src="graphics/holc-scan.jpg"
                        alt="1930s Home Owner's Loan Corporation Redlining Map of Lexington Kentucky">
                    <h4 class='txt-s'>
                        <p> Nelson et al. accessed January 25, 2022</p><br>
                    </h4>

                    <p> Hazard ratings assigned to neighborhoods were typically paired with descriptions of the
                        neighborhood written by the
                        program appraisers. Descriptions were written and mapped in cities across the U.S. and for Grade
                        D area descriptions usually included
                        some form of not so subtle racist reference to <i>"infiltration"</i> by an <i>"undesirable"</i>
                        or <i>"low grade"</i> population. Populations included among these descriptions
                        were <i>"Colored", "Italian", "Jewish", "Negroes", "Asiatics", "Orientals", "Polish",
                            "Hungarian", "Czech", "Greek", "Mexican", "Russian", "Slavic"</i> or <i>"Syrian". </i>
                    </p><br>

                    <h3 class='txt-m txt-bold mb6'>References</h3>
                    <p> C. L. Harriss, History and Policies of the Home Owners' Loan Corporation (New York: National
                        Bureau
                        of Economic Research, 1951), p. 1, p. 43.
                    </p><br>
                    <p> Robert K. Nelson, LaDale Winling, Richard Marciano, Nathan Connolly, et al., “Mapping
                        Inequality,”
                        American Panorama, ed. Robert K. Nelson and Edward L. Ayers, accessed January 25, 2022,
                        <a
                            href="https://dsl.richmond.edu/panorama/redlining//#loc=14/38.041/-84.526&city=lexington-ky&text=downloads">Mapping
                            Inequality-Lexington</a>
                    </p><br>

                    <div class="modal-footer">
                        <a target="_blank" href="https://github.com/RCRamsey/map698-redlining-wealth-lexington">
                            <button type="button"
                                class="btn btn--stroke btn--white bg-darken25 bg-darken50-on-hover bg-gray-dark-on-active txt-xs ml3">View
                                GitHub Repo</button>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <script async defer src="https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js'></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- using plugin for opacity -->
    <script type='module' src="js/app.js"></script>

    <script>

        // map & map 2 access token
        mapboxgl.accessToken =
            'pk.eyJ1IjoicmNyYW1zZXkiLCJhIjoiY2wxNTJkeDkxMmE2NzNrcnR1YWp4bTJuZSJ9.VJgeO7B_6LZ3Uv9NTzaNVQ'

        // map 1 script
        const map = new mapboxgl.Map({
            container: 'map', //container ID
            style: 'mapbox://styles/rcramsey/cl3k1etf1002c14lxlfg3l57v',// ✏️ style URL refine later
            center: [-84.51, 38.04], //strating position [lng, lat]
            zoom: 12 //starting zoom
        });

        // remove later ... part of dev tools
        // const slider = document.getElementById('slider');
        // slider.addEventListener('input', (e) => {
        //     // Adjust the layers opacity.
        //     map.setPaintProperty(
        //         // source Id
        //         'redlining',
        //         // when the layer is created in mapbox from my geojson, it is added as a raster? right?
        //         'fill-opacity',
        //         parseInt(e.target.value, 10) / 100
        //     );
        //     // Value Indicator
        //     sliderValue.textContent = e.target.value + '%';
        // });

        // const sliderValue = document.getElementById('slider-value');

        // About Map modal access using native js
        var aboutMapModal = document.getElementById("aboutMapModal");
        // Get button that opens the modal
        const aboutBtn = document.getElementById('aboutMapButton');
        // Get the <span> element that closes the modal
        // since the span class for closing is different between the two modals would use 0 in index for both
        const spanCloseAboutMapModal = document.getElementsByClassName("closeAbout")[0];  
        // When the user clicks the button, open the modal 
        aboutBtn.onclick = function () {
            aboutMapModal.style.display = "block";
        };

        // When user clicks on <spanCloseAboutMapModal> close aboutMapModal
        spanCloseAboutMapModal.onclick = function () {
            aboutMapModal.style.display = "none";
        }
        // When the user clicks anywhere outside of the modal, close it
        window.addEventListener("click", function (event) {
            if (event.target == aboutMapModal) {
                aboutMapModal.style.display = "none";
            }
        })

        // About Redlining Modal UI access using native js
        var redliningModal = document.getElementById("redliningModal");
        // Get button that opens the modal
        const redliningBtn = document.getElementById('redliningButton');
        // Get the <span> element that closes the modal
        const spanCloseRedliningModal = document.getElementsByClassName("close")[0];  
        // When the user clicks the button, open the modal 
        redliningBtn.onclick = function () {
            redliningModal.style.display = "block";
        };

        // When user clicks on <spanCloseRedliningModal> close redliningModal
        spanCloseRedliningModal.onclick = function () {
            redliningModal.style.display = "none";
        };
        
        // When the user clicks anywhere outside of the modal, close it
        window.addEventListener("click", function (event) {
            if (event.target == redliningModal) {
                redliningModal.style.display = "none";
            }
        })

        // use D3 method on map 1 to load GeoJSON when the map is finished loading
        map.on('load', () => {
            // request GEOJSON data
            d3.json('./data/KYLexington1936.geojson').then((geojson) => {
                // when loaded
                console.log(geojson);

                // call addLayer() function in scope
                addLayer(geojson);
            });
        });

        // define addLayer() function outside of scope
        function addLayer(geojson) {
            // add the source to the map
            map.addSource('redlining', {
                'type': 'geojson',
                'data': geojson // use my data as source
            });

            // add the GeoJSON data as a mapbox gl layer (now a raster?) to visualize polygon
            map.addLayer({
                'id': 'redlining', // provide new id for later reference 
                'type': 'fill',
                'source': 'redlining', //refers to data source name entered above
                'paint': {
                    'fill-color': [ // '#00364e', initial fill color until add identity
                        'match',
                        ['get', 'holc_grade'],
                        'A',
                        '#5B7386',
                        'B',
                        '#92A6B5',
                        'C',
                        '#C2CDD6',
                        'D',
                        '#E6EBEF',
                        // other not caught
                        'black'
                    ],
                    'fill-opacity': .7, //initial opacity until slider added
                    'fill-outline-color': 'black'
                }
            });

            // Create a popup for redlined map, but don't add it to the map yet.
            const redlined_popup = new mapboxgl.Popup({
                closeButton: true,
                closeOnClick: true
            });

            // Click event on layer to produce popup of properties based on event clicked
            map.on('click', 'redlining', (e) => {
                // Change the cursor style as UI Indicator
                map.getCanvas().style.cursor = 'pointer';

                //Access properties of event location selected to add to popup
                const redlinedGrade = e.features[0].properties.holc_grade;
                //Populate popup and set its coordinates based on click
                redlined_popup.setLngLat(e.lngLat).setHTML("<h3>Redlined Grade:</h3> " + redlinedGrade).addTo(map);
            });

            // On leaving layer remove popup and revert back to initial cursor style
            map.on('mouseleave', 'redlining', () => {
                map.getCanvas().style.cursor = '';
                // redlined_popup.remove();
            });
        };

        // map 2 script
        const map2 = new mapboxgl.Map({
            container: 'map2', //container ID
            style: 'mapbox://styles/rcramsey/cl3k1etf1002c14lxlfg3l57v',// ✏️ style URL refine later
            center: [-84.51, 38.04], //starting position [lng, lat]
            zoom: 12 //starting zoom
        });

        // use D3 method on map 2 to load GeoJSON when the map is finished loading
        map2.on('load', () => {
            // request GEOJSON data
            //d3.json('./data/KYLexington1936.geojson').then((geojson) => {
            d3.json('./data/race_cbtracts_hhi_own_val_pov_2019_json_numerical.json').then((geojson) => {
                // when loaded
                console.log(geojson);
                // call addLayer() function in scope
                addLayer2(geojson);
                mapSync();
            });

        });

        // define addLayer() function outside of scope
        function addLayer2(geojson) {
            // add the source to the map
            map2.addSource('census', {
                'type': 'geojson',
                'data': geojson // use my data as source
            });

            // add the GeoJSON data as a mapbox gl layer to visualize polygon
            // access census bureau race/segretation data
            map2.addLayer({
                'id': 'race', // provide new id for later reference 
                'type': 'fill',
                'source': 'census', //refers to data source name entered above
                'layout':
                {
                    'visibility': 'visible'
                },
                'paint': {
                    'fill-color': {
                        property: '%White',
                        stops: [[0, '#FFFFFF'], [25, '#C5E2FC'], [75, '#51ABF6'], [100, '#115292']],
                    },
                    'fill-opacity': .70, //initial opacity until slider added
                    'fill-outline-color': 'black'
                }
            });

            // access census bureaus median income data
            map2.addLayer({
                'id': 'income', // provide new id for later reference 
                'type': 'fill',
                'source': 'census', //refers to data source name entered above
                'layout':
                {
                    'visibility': 'none'
                },
                'paint': {
                    'fill-color': {
                        property: 'median_income_dollars',
                        stops: [[20000, '#E7EFEE'], [50000, '#B6CECC'], [80000, '#89B0AE'], [120000, '#629390']],
                    },
                    'fill-opacity': .70, //initial opacity until slider added
                    'fill-outline-color': 'black'
                }
            });

            // access census bureau ownership vs rental status data
            map2.addLayer({
                'id': 'ownership', // provide new id for later reference 
                'type': 'fill',
                'source': 'census', //refers to data source name entered above
                'layout':
                {
                    'visibility': 'none'
                },
                'paint': {
                    'fill-color': {
                        property: '%owner',
                        stops: [[0, '#F7D1CD'], [25, '#D1B3C4'], [75, '#B392AC'], [100, '#735D78']],
                    },
                    'fill-opacity': .70, //initial opacity until slider added
                    'fill-outline-color': 'black'
                }
            });

            // // Access census bureau property data
            map2.addLayer({
                'id': 'propertyValue', // provide new id for later reference 
                'type': 'fill',
                'source': 'census', //refers to data source name entered above
                'layout':
                {
                    'visibility': 'none'
                },
                'paint': {
                    'fill-color': {
                        property: 'medianDollarHome',
                        stops: [[40000, '#AAC5AA'], [80000, '#92B592'], [160000, '#6E9C6D'], [320000, '#3A5A40'], [640000, '#293D33']],
                    },
                    'fill-opacity': .70, //initial opacity until slider added
                    'fill-outline-color': 'black'
                }
            });

            addUI();
            whatsMap2Style('race', geojson);
        };


        // Use d3 to select all 'a' targets in dropdown menu
        // when clicked the value of that current target is passed to function updateCurrentLayer
        function addUI() {
            d3.selectAll('.dropdown-content a').on('click', (e) => {
                let currentValue = d3.select(e.target).attr('value');
                updateCurrentLayer(currentValue);
                whatsMap2Style(currentValue);
            });
        }

        // pass value from div class drop down content in drop down menu
        // function to set all visibility to none until.
        function updateCurrentLayer(val) {
            map2.setLayoutProperty('race', 'visibility', 'none');
            map2.setLayoutProperty('income', 'visibility', 'none');
            map2.setLayoutProperty('ownership', 'visibility', 'none');
            map2.setLayoutProperty('propertyValue', 'visibility', 'none');
            // change visibility to visible for whicheer val is clicked in drop down menu
            map2.setLayoutProperty(val, 'visibility', 'visible');
        }

        // Map & Map 2 syncing movement
        function mapSync() {
            // if disable true then the map will be displayed as non-interactive
            var disable = false; // interactive
            map.on('move', function () {

                if (!disable) { // boolean, if not do below
                    var center = map.getCenter();
                    var zoom = map.getZoom();

                    // convert disable to be true
                    // prevents looping between both maps so only one can be moved
                    disable = true; // map 1 non interactive (static)

                    // set map 2 to new map center & zoom
                    map2.setCenter(center);
                    map2.setZoom(zoom);
                    disable = false; // map 1 back to interactive
                }
            })

            map2.on('move', function () {
                if (!disable) { // boolean, it not true do below
                    var center = map2.getCenter();
                    var zoom = map2.getZoom();

                    // convert disable to be true
                    // prevents looping between both maps so only one can be moved
                    disable = true; // map 2 non interactive (static)

                    // set first map to new map 2 center & zoom
                    map.setCenter(center);
                    map.setZoom(zoom);
                    disable = false; // map 2 back to interactive
                }
            })
        };

        //Updating legend to reflect map2 layer styles
        //Determine UI layer selected
        //apply appropriate color gradient to legend
        //access appropriate set of data for popups
        function whatsMap2Style(val, geojson) {
            // access legend-bar for color gradient modification
            let legend2Bar = document.getElementById('legend2-bar');
            let legend2Title = document.getElementById('legend2');
            let legend2Min = document.getElementById('legend2-label-min');
            let legend2Max = document.getElementById('legend2-label-max');

            // Create a popup, but don't add it to the map yet.
            const popup = new mapboxgl.Popup({
                closeButton: true,
                closeOnClick: true
            });

            // if value from UI is race update color gradient to legend
            if (val == 'race') {
                console.log('value is race');
                legend2Bar.style.background = 'linear-gradient(to right, #FFFFFF, #C5E2FC, #51ABF6, #115292)';
                // place holder for accessing and modifying text to legend
                legend2Title.innerHTML = '<h3>% White Population</h3>';
                legend2Min.innerHTML = '<h3>Low</h3>';
                legend2Max.innerHTML = '<h3>High</h3>';

                // Access geojson data for race layer here
                console.log(geojson)

                // Click event on layer to produce popup of properties based on event clicked
                map2.on('click', 'race', (e) => {
                    // Change the cursor style as UI Indicator
                    map.getCanvas().style.cursor = 'pointer';

                    //Access properties of event location selected to add to popup
                    const percentWhite = e.features[0].properties['%White'];
                    //Populate popup and set its coordinates based on click
                    popup.setLngLat(e.lngLat).setHTML("<h3>Percent White Population:</h3> " + Math.round(percentWhite) + '%').addTo(map2);
                });

                // On leaving layer remove popup and revert back to initial cursor style
                map2.on('mouseleave', 'race', () => {
                    map.getCanvas().style.cursor = '';
                    // popup.remove();
                });

                // if value from UI is income update color gradient to legend
            } else if (val == 'income') {
                console.log('value is income');
                legend2Bar.style.background = 'linear-gradient(to right, #E7EFEE, #B6CECC, #89B0AE, #629390)';
                legend2Title.innerHTML = '<h3>Median Income</h3>';
                legend2Min.innerHTML = '<h3>Lower</h3>';
                legend2Max.innerHTML = '<h3>Higher</h3>';

                // Click event on layer to produce popup of properties based on event clicked
                map2.on('click', 'income', (e) => {
                    // Change the cursor style as UI Indicator
                    map.getCanvas().style.cursor = 'pointer';

                    //Access properties of event location selected to add to popup
                    const medIncome = e.features[0].properties.median_income_dollars;
                    //Populate popup and set its coordinates based on click
                    popup.setLngLat(e.lngLat).setHTML("<h3>Annual Median Household Income:</h3> " + "$" + medIncome.toLocaleString('en-US')).addTo(map2);
                });

                // On leaving layer remove popup and revert back to initial cursor style
                map2.on('mouseleave', 'race', () => {
                    map.getCanvas().style.cursor = '';
                    // popup.remove();
                });

                // if value from UI is ownership update color gradient to legend
            } else if (val == 'ownership') {
                console.log('value is ownership');
                legend2Bar.style.background = 'linear-gradient(to right, #F7D1CD, #D1B3C4, #B392AC, #735D78 )';
                legend2Title.innerHTML = '<h3>% Ownership</h3>';
                legend2Min.innerHTML = '<h3>Low</h3>';
                legend2Max.innerHTML = '<h3>High</h3>';

                map2.on('click', 'ownership', (e) => {
                    // Change the cursor style as UI Indicator
                    map.getCanvas().style.cursor = 'pointer';

                    //Access properties of event location selected to add to popup
                    const percentOwn = e.features[0].properties['%owner'];
                    //Populate popup and set its coordinates based on click
                    popup.setLngLat(e.lngLat).setHTML("<h3>Percent of Home Owners:</h3> " + Math.round(percentOwn) + '%').addTo(map2);
                });

                // On leaving layer remove popup and revert back to initial cursor style
                map2.on('mouseleave', 'ownership', () => {
                    map.getCanvas().style.cursor = '';
                    // popup.remove();
                });
            }
            // if value from UI is propertyValue update color gradient to legend
            else if (val == 'propertyValue') {
                console.log('value is propertyValue');
                legend2Bar.style.background = 'linear-gradient(to right, #AAC5AA, #92B592, #6E9C6D, #3A5A40, #293D33)';
                legend2Title.innerHTML = '<h3>Median Reported Property Value</h3>';
                legend2Min.innerHTML = '<h3>Lower</h3>';
                legend2Max.innerHTML = '<h3>Higher</h3>';

                map2.on('click', 'propertyValue', (e) => {
                    // Change the cursor style as UI Indicator
                    map.getCanvas().style.cursor = 'pointer';

                    //Access properties of event location selected to add to popup
                    const reportedMedPropValue = e.features[0].properties.medianDollarHome;
                    const numberSelfReportedProperty = e.features[0].properties['ownVal1mill+'] 
                                                        + e.features[0].properties['ownVal50-99.9k']
                                                        + e.features[0].properties['ownVal100-149.9k']
                                                        + e.features[0].properties['ownVal150-199.9k']
                                                        + e.features[0].properties['ownVal200-299.9k']
                                                        + e.features[0].properties['ownVal300-499.9k']
                                                        + e.features[0].properties['ownVal500-999.9k']
                                                        + e.features[0].properties['ownVal<50k']
                    //Populate popup and set its coordinates based on click
                    popup.setLngLat(e.lngLat).setHTML("<h3>Median Property Value Reported:</h3> " + "$" + reportedMedPropValue.toLocaleString('en-US')
                    + "<br><h3># Properties Self Reported: </h3>" + numberSelfReportedProperty).addTo(map2);
                });

                // On leaving layer remove popup and revert back to initial cursor style
                map2.on('mouseleave', 'propertyValue', () => {
                    map.getCanvas().style.cursor = '';
                    // popup.remove();
                });
            }
            // if no value is accessible produce comment in console log
            else {
                console.log('no value selected');
            };
        };


    </script>

</body>

</html>